### Tests API Finance EcosystIA - APIs REST R√©elles üí∞
### Gestion compl√®te : Factures, D√©penses, Budgets, Paiements

@baseUrl = http://localhost:8000/api/v1
@contentType = application/json
@authToken = YOUR_JWT_TOKEN_HERE

### ========================================
### üí∞ FINANCE API - TESTS R√âELS
### ========================================

### 1. Cr√©er une facture r√©elle
POST {{baseUrl}}/finance/invoices/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "client_name": "SONATEL S√©n√©gal",
  "client_email": "facturation@sonatel.sn",
  "client_address": "46 Boulevard de la R√©publique, Dakar, S√©n√©gal",
  "amount": 2500000.00,
  "tax_amount": 450000.00,
  "total_amount": 2950000.00,
  "currency": "XOF",
  "status": "Draft",
  "issue_date": "2024-09-20",
  "due_date": "2024-10-20",
  "description": "Formation Django REST Framework pour 15 d√©veloppeurs",
  "terms_conditions": "Paiement √† 30 jours. P√©nalit√©s de retard : 2% par mois.",
  "notes": "Formation sur site avec certification"
}

### 2. Lister toutes les factures
GET {{baseUrl}}/finance/invoices/
Authorization: Bearer {{authToken}}

### 3. R√©cup√©rer une facture sp√©cifique
GET {{baseUrl}}/finance/invoices/1/
Authorization: Bearer {{authToken}}

### 4. Enregistrer un paiement sur une facture
POST {{baseUrl}}/finance/invoices/1/payment/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "amount": 1000000.00,
  "method": "Bank Transfer",
  "payment_date": "2024-09-25",
  "reference_number": "VIR-20240925-001"
}

### 5. G√©n√©rer le PDF d'une facture
GET {{baseUrl}}/finance/invoices/1/pdf/
Authorization: Bearer {{authToken}}

### 6. Envoyer un rappel de paiement
POST {{baseUrl}}/finance/invoices/1/reminder/
Authorization: Bearer {{authToken}}

### 7. Cr√©er une d√©pense r√©elle
POST {{baseUrl}}/finance/expenses/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "category": "Software",
  "description": "Licence annuelle GitHub Enterprise",
  "amount": 180000.00,
  "currency": "XOF",
  "status": "Unpaid",
  "date": "2024-09-20",
  "due_date": "2024-10-05",
  "vendor": "GitHub Inc.",
  "reference_number": "GH-ENT-2024-001"
}

### 8. Lister toutes les d√©penses
GET {{baseUrl}}/finance/expenses/
Authorization: Bearer {{authToken}}

### 9. Marquer une d√©pense comme pay√©e
POST {{baseUrl}}/finance/expenses/1/payment/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "method": "Credit Card",
  "payment_date": "2024-09-22",
  "reference_number": "CC-20240922-001"
}

### 10. Cr√©er un budget projet
POST {{baseUrl}}/finance/budgets/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "title": "Budget D√©veloppement EcosystIA Q4 2024",
  "type": "Project",
  "amount": 5000000.00,
  "currency": "XOF",
  "start_date": "2024-10-01",
  "end_date": "2024-12-31",
  "description": "Budget pour le d√©veloppement de la plateforme EcosystIA"
}

### 11. Lister tous les budgets
GET {{baseUrl}}/finance/budgets/
Authorization: Bearer {{authToken}}

### 12. Cr√©er un compte bancaire
POST {{baseUrl}}/finance/accounts/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "name": "Compte Principal EcosystIA",
  "account_type": "Business",
  "account_number": "SN12345678901234567890",
  "bank_name": "Banque Atlantique S√©n√©gal",
  "currency": "XOF",
  "initial_balance": 10000000.00
}

### 13. Lister les comptes bancaires
GET {{baseUrl}}/finance/accounts/
Authorization: Bearer {{authToken}}

### 14. Cr√©er une transaction bancaire
POST {{baseUrl}}/finance/transactions/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "account": 1,
  "transaction_type": "Credit",
  "category": "Invoice Payment",
  "amount": 1000000.00,
  "description": "Paiement re√ßu de SONATEL pour formation Django",
  "reference_number": "TRX-20240925-001",
  "transaction_date": "2024-09-25"
}

### 15. Calculer les taxes sur un montant
POST {{baseUrl}}/finance/calculate-tax/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "amount": 2500000.00,
  "tax_id": 1
}

### 16. Configuration des taxes
GET {{baseUrl}}/finance/taxes/
Authorization: Bearer {{authToken}}

### 17. Cr√©er une configuration de taxe
POST {{baseUrl}}/finance/taxes/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "name": "TVA S√©n√©gal",
  "rate": 18.00,
  "is_active": true
}

### ========================================
### üìä ANALYTICS ET RAPPORTS R√âELS
### ========================================

### 18. Statistiques financi√®res compl√®tes
GET {{baseUrl}}/finance/stats/?year=2024
Authorization: Bearer {{authToken}}

### 19. Dashboard financier complet
GET {{baseUrl}}/finance/dashboard/
Authorization: Bearer {{authToken}}

### 20. Rapport de flux de tr√©sorerie
GET {{baseUrl}}/finance/cash-flow/?months=12
Authorization: Bearer {{authToken}}

### 21. G√©n√©rer un rapport financier
POST {{baseUrl}}/finance/reports/generate/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "report_type": "Income Statement",
  "period_start": "2024-01-01",
  "period_end": "2024-12-31"
}

### ========================================
### üîç FILTRES ET RECHERCHES AVANC√âES
### ========================================

### 22. Filtrer les factures en retard
GET {{baseUrl}}/finance/invoices/?is_overdue=true&status=Sent
Authorization: Bearer {{authToken}}

### 23. Rechercher des factures par client
GET {{baseUrl}}/finance/invoices/?search=SONATEL&amount_min=1000000
Authorization: Bearer {{authToken}}

### 24. Filtrer les d√©penses par cat√©gorie et p√©riode
GET {{baseUrl}}/finance/expenses/?category=Software&date_from=2024-09-01&date_to=2024-09-30
Authorization: Bearer {{authToken}}

### 25. Transactions par compte et type
GET {{baseUrl}}/finance/transactions/?account=1&transaction_type=Credit&date_from=2024-09-01
Authorization: Bearer {{authToken}}

### 26. Budgets actifs seulement
GET {{baseUrl}}/finance/budgets/?is_active=true
Authorization: Bearer {{authToken}}

### ========================================
### üíº SC√âNARIOS M√âTIER R√âELS
### ========================================

### 27. Sc√©nario : Cycle complet de facturation
# 1. Cr√©er facture ‚Üí 2. Envoyer ‚Üí 3. Recevoir paiement partiel ‚Üí 4. Rappel ‚Üí 5. Paiement final

# √âtape 1: Cr√©er la facture
POST {{baseUrl}}/finance/invoices/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "client_name": "Orange S√©n√©gal",
  "client_email": "partenariats@orange.sn",
  "amount": 5000000.00,
  "tax_amount": 900000.00,
  "total_amount": 5900000.00,
  "currency": "XOF",
  "status": "Sent",
  "issue_date": "2024-09-20",
  "due_date": "2024-11-20",
  "description": "Formation compl√®te IA et Machine Learning - 25 participants"
}

### 28. √âtape 2: Paiement partiel
POST {{baseUrl}}/finance/invoices/2/payment/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "amount": 3000000.00,
  "method": "Bank Transfer",
  "payment_date": "2024-10-15",
  "reference_number": "ORANGE-PAY-001"
}

### 29. √âtape 3: Envoyer rappel pour le solde
POST {{baseUrl}}/finance/invoices/2/reminder/
Authorization: Bearer {{authToken}}

### 30. Sc√©nario : Gestion de budget projet
# 1. Cr√©er budget ‚Üí 2. Ajouter d√©penses ‚Üí 3. Suivre utilisation

# Budget pour projet de formation IA
POST {{baseUrl}}/finance/budgets/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "title": "Budget Formation IA - Orange S√©n√©gal",
  "type": "Project",
  "amount": 3000000.00,
  "currency": "XOF",
  "start_date": "2024-10-01",
  "end_date": "2024-12-31",
  "description": "Budget allou√© pour la formation IA d'Orange S√©n√©gal"
}

### 31. D√©pense li√©e au budget
POST {{baseUrl}}/finance/expenses/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "category": "Training",
  "description": "Mat√©riel p√©dagogique et supports de cours IA",
  "amount": 500000.00,
  "currency": "XOF",
  "status": "Paid",
  "date": "2024-10-02",
  "vendor": "Tech Books & Materials",
  "budget_item_id": 1
}

### 32. Sc√©nario : Suivi de tr√©sorerie
# V√©rifier les flux de tr√©sorerie mensuels
GET {{baseUrl}}/finance/cash-flow/?months=6
Authorization: Bearer {{authToken}}

### 33. Sc√©nario : Rapport de fin de mois
POST {{baseUrl}}/finance/reports/generate/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "report_type": "Cash Flow",
  "period_start": "2024-09-01",
  "period_end": "2024-09-30"
}

### ========================================
### üöÄ TESTS DE PERFORMANCE
### ========================================

### 34. Test pagination - Factures
GET {{baseUrl}}/finance/invoices/?page=1&page_size=20
Authorization: Bearer {{authToken}}

### 35. Test filtres multiples - D√©penses
GET {{baseUrl}}/finance/expenses/?category=Software&status=Paid&amount_min=100000&date_from=2024-01-01
Authorization: Bearer {{authToken}}

### 36. Test recherche - Toutes entit√©s
GET {{baseUrl}}/finance/invoices/?search=formation&amount_min=1000000
Authorization: Bearer {{authToken}}

### ========================================
### ‚úÖ VALIDATION DES DONN√âES M√âTIER
### ========================================

### 37. Test validation - Montant n√©gatif (doit √©chouer)
POST {{baseUrl}}/finance/invoices/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "client_name": "Test Client",
  "amount": -1000.00,
  "total_amount": -1000.00,
  "issue_date": "2024-09-20",
  "due_date": "2024-10-20"
}

### 38. Test validation - Date incoh√©rente (doit √©chouer)
POST {{baseUrl}}/finance/expenses/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "category": "Software",
  "description": "Test d√©pense",
  "amount": 100000.00,
  "date": "2024-12-31",
  "due_date": "2024-01-01"
}

### 39. Test paiement - Montant sup√©rieur au solde (doit √©chouer)
POST {{baseUrl}}/finance/invoices/1/payment/
Authorization: Bearer {{authToken}}
Content-Type: {{contentType}}

{
  "amount": 99999999.00,
  "method": "Bank Transfer"
}

### ========================================
### üìà ANALYTICS M√âTIER AVANC√âES
### ========================================

### 40. Analytics par p√©riode personnalis√©e
GET {{baseUrl}}/finance/stats/?year=2024
Authorization: Bearer {{authToken}}

### 41. Flux de tr√©sorerie d√©taill√©
GET {{baseUrl}}/finance/cash-flow/?months=12
Authorization: Bearer {{authToken}}

### 42. Dashboard avec toutes les m√©triques
GET {{baseUrl}}/finance/dashboard/
Authorization: Bearer {{authToken}}

### ========================================
### üéØ TESTS INT√âGRATION M√âTIER
### ========================================

### 43. Workflow complet : Facture ‚Üí Paiement ‚Üí Rapport
# Utilisez les endpoints pr√©c√©dents dans l'ordre :
# 1. Cr√©er facture (test 1)
# 2. Enregistrer paiement (test 4)
# 3. V√©rifier dans dashboard (test 42)

### 44. Workflow budget : Cr√©ation ‚Üí D√©penses ‚Üí Suivi
# 1. Cr√©er budget (test 10)
# 2. Ajouter d√©penses (test 31)
# 3. V√©rifier utilisation dans stats (test 40)

### ========================================
### ‚úÖ API FINANCE COMPL√àTE ET OP√âRATIONNELLE
### ========================================
### 
### Fonctionnalit√©s r√©elles impl√©ment√©es :
### ‚úÖ Gestion compl√®te des factures avec paiements partiels
### ‚úÖ Suivi des d√©penses par cat√©gorie et budget
### ‚úÖ Budgets avec lignes et √©l√©ments d√©taill√©s
### ‚úÖ Comptes bancaires avec transactions
### ‚úÖ Calculs de taxes automatiques
### ‚úÖ Rapports financiers g√©n√©r√©s dynamiquement
### ‚úÖ Analytics temps r√©el avec m√©triques m√©tier
### ‚úÖ Workflow complets de gestion financi√®re
### ‚úÖ Validation m√©tier stricte
### ‚úÖ Filtres et recherches avanc√©es
### 
### Pr√™te pour la production ! üöÄüí∞
